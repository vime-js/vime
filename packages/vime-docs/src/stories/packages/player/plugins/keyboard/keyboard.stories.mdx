import { Meta } from '@storybook/addon-docs/blocks';
import LinkTo from "@storybook/addon-links/react";

<Meta title="Packages/Player/Plugins/Keyboard/Keyboard" />

# Keyboard `Plugin`

[View Source](https://github.com/vime-js/vime/blob/master/packages/vime-player/src/plugins/keyboard/Keyboard.svelte)

**ID:** `vKeyboard`

This plugin manages keyboard shortcuts (see <LinkTo kind="packages-player-plugins-keyboard-keyboardshortcut--page">Keyboard/KeyboardShortcut</LinkTo> ).

ðŸ’¡ To see this plugin in action then go to 'Player/Components'.

ðŸ“ This plugin has a `Registry` that can be accessed through the root registry under the `ID` listed above.

## Default Shortcuts

By default it has no shortcuts, but you can install an additional `DefaultKeyboard` plugin to get 
started with the Vime defaults.

- `togglePlayback`: `space/k` to toggle playback.
- `adjustVolume`: `up arrow` and `down arrow` to control the volume level.
- `seek`: `left arrow` and `right arrow` to seek forward/backward.
- `toggleMute`: `m` to toggle the muted state of the player.
- `toggleCaptions`: `c` to toggle captions on/off.
- `togglePiP`: `p` to toggle PiP on/off.
- `toggleFullscreen`: `f` to toggle fullscreen on/off.

## Setup

### `plugins`

```js
import { Keyboard, DefaultKeyboard } from '@vime-js/player';

player.plugins = [Keyboard, DefaultKeyboard];
```

### `PluginsManager`

```js
import { Keyboard, DefaultKeyboard } from '@vime-js/player';

player
  .getPluginsManager()
  .addPlugins([Keyboard, DefaultKeyboard])
  .then(([keyboard]) => {
    // ...
  });
```

## Usage

### Create Shortcut

```js
player.vKeyboard.addShortcut('togglePlayback', {
  hint: 'space/k',
  keys: [32, 75],
  action: () => {
    if (!player.canInteract) return;
    player.paused = !player.paused;
  }
});
```

### Update Shortcut

```js
player.vKeyboard.updateShortcut('togglePlayback', {
  hint: 'space',
  keys: [32]
});
```

### Delete Shortcut

```js
player.vKeyboard.removeShortcut('togglePlayback');
```

### Access Shortcut via Event

```js
player.vKeyboard.$on('register', registration => {
  const { id, value: shortcut } = registration;
  if (id === 'togglePlayback') {
    // ...
  }
});
```

### Access Shortcut via Registry

```js
player.vKeyboard.getRegistry().subscribe(shortcuts => {
  const shortcut = shortcuts.togglePlayback;
  if (shortcut) {
    // ...
  }
});
```

## Relationships

### ActionDisplay

If the <LinkTo kind="packages-player-plugins-actiondisplay--page">ActionDisplay</LinkTo> plugin is 
available then all key presses will emit an icon/value in the middle of the player to display the action taken.

### Tooltips

If the <LinkTo kind="packages-player-plugins-tooltips-tooltips--page">Tooltips</LinkTo> plugin is available, 
then the `Keyboard` plugin will look for any registered `Tooltip` with a matching `id` to a keyboard shortcut, 
if found it will set the `hint` prop to the keyboard shortcut `hint`. For example, if a title is "play", 
it will become "play (space / k)".

## Props

### `autopilot: boolean`

**Default:** `true`

In autopilot mode the plugin will control certain properties automatically. Set this to `false` if you'd like to 
control them yourself. Properties marked with `auto` are part of this system.

### `isEnabled: boolean` `(auto)`

**Default:** `true`

Whether the plugin is enabled or not.

## Methods

### `getRegistry(): Registry`

The plugin registry where `KeyboardShortcut` objects are registered (see <LinkTo kind="api-registry--page">API/Registry</LinkTo>).

### `getShortcuts(): KeyboardShortcut[]`

All registered keyboard shortcuts.

### `getShortcut(id: string): KeyboardShortcut|undefined`

The keyboard shortcut object for the given `id`.

### `addShortcut(id: string, shortcut: KeyboardShortcut)`

Creates and regsiters a keyboard shortcut.

### `updateShortcut(id: string, shortcut: KeyboardShortcut)`

Updates the keyboard shortcut associated with the given `id`.

### `removeShortcut(id: string)`

Removes and deregisters the keyboard shortcut for the given `id`.

### `removeShortcuts(ids: string[])`

Removes and deregisters multiple keyboard shortcuts.

## Events

See <LinkTo kind="api-registry--page#events">API/Registry - Events.</LinkTo>