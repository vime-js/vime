import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="API/LitePlayer" />

# LitePlayer `interface`

## Props

### `srcId: string|null`

**Default:** `null`

The src id of the media you'd like to embed. For example, for YouTube this would be the video ID.

### `params: object`

**Default:** `{}`

The parameters you'd like to pass to the player. These are encoded and appended to the embed URL.

**Player Parameters:**

- [YouTube](https://developers.google.com/youtube/player_parameters#Parameters)
- [Vimeo](https://developer.vimeo.com/player/sdk/embed#embed-options)
- [Dailymotion](https://developer.vimeo.com/player/sdk/embed#embed-options)

### `aspectRatio: string|null`

**Default:** `16:9`

The aspect ratio of the player expressed as `width:height`.

## Methods

### `getSrc(): string|null`

The embed URL (no parameters) for the current media.

### `getSrcWithParams(): string|null`

The embed URL and all parameters attached.

### `getOrigin(): string`

Where the `src` request had originated from without any path information.

### `getTitle(): string|null`

The title of the current media.

### `getIframe(): HTMLIFrameElement`

The DOM node for the embedded `<iframe>`.

### `sendCommand(command: string, args: any, force: boolean)`

Sends commands to the embed via [postmessage](https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage). These 
commands are sent through when the media is ready for playback, however you can `force` the command to 
be sent through immediately. The way this method is used depends on the respective provider. 

Traditional Player SDK's abstract this away for you at the cost of size, however it's really easy
to use. We have a primer for each provider below, but if you find any of this uncomfortable, then 
consider our Standard player (~8 kB heavier) to abstract this all away for you.

**YouTube Primer**

- Getting Property: There are no getter commands. We listen to the [data](#data) event for continous updates on all properties.
- Setting Property: `sendCommand('setVolume', [50])`
- Calling Method: `sendCommand('playVideo')`

ðŸ“ See our [YouTubeProvider](https://github.com/vime-js/vime/blob/master/packages/vime-youtube/src/YouTubeProvider.svelte) for more examples.

ðŸ“ For all available commands, see the [YouTube API Reference](https://developers.google.com/youtube/iframe_api_reference#Playback_controls).

**Vimeo Primer**

- Getting Property: `sendCommand('getCurrentTime')` and then we listen to the [data](#data) event for an update.
- Setting Property: `sendCommand('setVolume', 50)`
- Calling Method: `sendCommand('play')`

ðŸ“ See our [VimeoProvider](https://github.com/vime-js/vime/blob/master/packages/vime-vimeo/src/VimeoProvider.svelte) for more examples.

ðŸ“ For all available commands, see the [Vimeo API Reference](https://developer.vimeo.com/player/sdk/reference#methods-for-playback-controls).

**Dailymotion Primer**

- Getting Property: There are no getter commands. We listen to the [data](#data) event for continous updates on all properties.
- Setting Property: `sendCommand('volume', [50])`
- Calling Method: `sendCommand('play')`

ðŸ“ See our [DailymotionProvider](https://github.com/vime-js/vime/blob/master/packages/vime-dailymotion/src/DailymotionProvider.svelte) for more examples.

ðŸ“ For all available commands, see the [Dailymotion API Reference](https://developer.dailymotion.com/player/#player-api-properties).

## Events

```js
// Start listening.
const off = player.$on("someEvent", e => {
  const data = e.detail;
});

// Stop listening.
off();
```

### `load`

**Data Type:** `undefined`

When the embed has initially loaded but it is not ready for playback.

### `message`

**Data Type:** `string`

When messages are posted from the embed.

### `data`

**Data Type:** `object`

Similar to the `messsage` event, except data is decoded into a POJO. This is most likely the main
event you'll be interacting with. This is where you'll receive updates on the state of the player, 
or the response to any commands you send through. We've made a little primer on each below.

**YouTube Primer**

```js
const off = player.$on('data', e => {
  const { info } = e.detail;
  console.log(info);
});
```

**Vimeo Primer**

```js
// For events to be fired, we have to add an event listener first. For example if we wanted to 
// listen to time updates.
player.sendCommand('addEventListener', 'timeupdate');

const off = player.$on('data', e => {
  const data = e.detail;
  if (!data) return;

  // If you send a "get" command, this is how you listen for the response.
  const { method, value } = data;
  console.log(method, value);
  
  // This is how you listen to events.
  const { event, data: payload } = data;
  console.log(event, payload);
});
```

ðŸ“ See [Vimeo Events Reference](https://developer.vimeo.com/player/sdk/reference#events-for-playback-controls).

**Dailymotion Primer**

```js
const off = player.$on('data', e => {
  const data = e.detail;
  const event = data && data.event;
  if (!event) return;
  
  // Data contains additional info regarding the event. If we were listening to timeupdates then 
  // data.time would have the current time.
  console.log(event, data);
});
```

### `srcchange`

**Data Type:** `string|null`

When the `src` attribute of the `iframe` is changed. This will fire when `srcId` or `params` changes.

### `originchange`

**Data Type:** `string|null`

When the origin where the `src` is being requested from changes.

### `rebuild`

**Data Type:** `undefined`

Similar to `srcchange`, but only fired if `src` is not `null`. This is mainly used to be notified of 
changes to `params`.

### `titlechange`

**Data Type:** `string|null`

When the title of the media changes.

### `error`

**Data Type:** `any`

When an error occurs with the intial setup of the player.