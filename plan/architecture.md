# Architecture

## Player

[![](https://mermaid.ink/img/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFBsYXllciB7XG4gICAgK2lkZW50aWZlcjogc3ltYm9sXG4gICAgK3NyYzogU291cmNlW11cbiAgICArcGF1c2VkOiBib29sZWFuXG4gICAgK3ZvbHVtZTogbnVtYmVyXG4gICAgLi4uXG4gICAgK2F1dG9Bc3BlY3RSYXRpbzogYm9vbGVhblxuICAgICthdXRvRmV0Y2hQb3N0ZXI6IGJvb2xlYW5cbiAgICAraGVhcnRiZWF0SW50ZXJ2YWw6IG51bWJlclxuICAgICtjdXJyZW50UHJvdmlkZXI_OiBNZWRpYVByb3ZpZGVyfmFueX5cbiAgICAjcGxheWVyU3RvcmU6IFBsYXllclN0b3JlXG5cbiAgICAjaGFuZGxlTWVkaWFDaGFuZ2UoKSB2b2lkXG4gICAgI2hhbmRsZVByb3ZpZGVyQ2hhbmdlKCkgdm9pZFxuICAgICtwbGF5KCkgUHJvbWlzZX52b2lkfiBcbiAgICArcGF1c2UoKSBQcm9taXNlfnZvaWR-IFxuICAgICtnZXRDYXB0dXJlU3RyZWFtKCkgTWVkaWFTdHJlYW18dW5kZWZpbmVkXG4gICAgK2dldEN1cnJlbnRQbGF5ZXJTdGF0ZSgpIFBsYXllclN0YXRlXG4gICAgK3N1YnNjcmliZShzdGF0ZSA9PiB2b2lkLCBkZWJvdW5jZU1zPzogbnVtYmVyKSBVbnN1YnNjcmliZVxufVxuXG5QbGF5ZXIgLS0gVmlld1R5cGVcblBsYXllciAtLSBNZWRpYVR5cGVcblBsYXllciBcIjFcIiAtLSogXCIwLi4qXCIgTWVkaWFQcm92aWRlcjogY29tcG9zaXRpb25cblxuY2xhc3MgUGxheWVyU3RvcmVcbmNsYXNzIFVuaXN0b3JlXG48PGxpYnJhcnk-PlVuaXN0b3JlXG5cblBsYXllclN0b3JlIC0tPiBVbmlzdG9yZTogdXNlc1xuUGxheWVyIC0tPiBQbGF5ZXJTdG9yZTogaGFzXG5cbmNsYXNzIFBsYXllclN0YXRlIHtcbiAgICA8PGludGVyZmFjZT4-XG4gICAgc3JjOiBTb3VyY2VbXVxuICAgIGN1cnJlbnRUaW1lOiBudW1iZXJcbiAgICB2b2x1bWU6IG51bWJlclxuICAgIHRyaW0_OiBNZWRpYVRyaW1cbiAgICBpblZpZXdwb3J0OiBib29sZWFuXG4gICAgLi4uXG59XG5cblBsYXllciAtLT4gUGxheWVyU3RhdGU6IGltcGxlbWVudHNcblBsYXllclN0b3JlIC0tPiBQbGF5ZXJTdGF0ZTogaW1wbGVtZW50c1xuXG5jbGFzcyBNZWRpYVRyaW0ge1xuICAgIDw8aW50ZXJmYWNlPj5cbiAgICBzdGFydFRpbWU6IG51bWJlclxuICAgIGVuZFRpbWU6IG51bWJlclxuICAgIGR1cmF0aW9uOiBudW1iZXJcbn1cblxuUGxheWVyU3RhdGUgLS0gTWVkaWFUcmltIiwibWVybWFpZCI6e30sInVwZGF0ZUVkaXRvciI6ZmFsc2V9)](https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFBsYXllciB7XG4gICAgK2lkZW50aWZlcjogc3ltYm9sXG4gICAgK3NyYzogU291cmNlW11cbiAgICArcGF1c2VkOiBib29sZWFuXG4gICAgK3ZvbHVtZTogbnVtYmVyXG4gICAgLi4uXG4gICAgK2F1dG9Bc3BlY3RSYXRpbzogYm9vbGVhblxuICAgICthdXRvRmV0Y2hQb3N0ZXI6IGJvb2xlYW5cbiAgICAraGVhcnRiZWF0SW50ZXJ2YWw6IG51bWJlclxuICAgICtjdXJyZW50UHJvdmlkZXI_OiBNZWRpYVByb3ZpZGVyfmFueX5cbiAgICAjcGxheWVyU3RvcmU6IFBsYXllclN0b3JlXG5cbiAgICAjaGFuZGxlTWVkaWFDaGFuZ2UoKSB2b2lkXG4gICAgI2hhbmRsZVByb3ZpZGVyQ2hhbmdlKCkgdm9pZFxuICAgICtwbGF5KCkgUHJvbWlzZX52b2lkfiBcbiAgICArcGF1c2UoKSBQcm9taXNlfnZvaWR-IFxuICAgICtnZXRDYXB0dXJlU3RyZWFtKCkgTWVkaWFTdHJlYW18dW5kZWZpbmVkXG4gICAgK2dldEN1cnJlbnRQbGF5ZXJTdGF0ZSgpIFBsYXllclN0YXRlXG4gICAgK3N1YnNjcmliZShzdGF0ZSA9PiB2b2lkLCBkZWJvdW5jZU1zPzogbnVtYmVyKSBVbnN1YnNjcmliZVxufVxuXG5QbGF5ZXIgLS0gVmlld1R5cGVcblBsYXllciAtLSBNZWRpYVR5cGVcblBsYXllciBcIjFcIiAtLSogXCIwLi4qXCIgTWVkaWFQcm92aWRlcjogY29tcG9zaXRpb25cblxuY2xhc3MgUGxheWVyU3RvcmVcbmNsYXNzIFVuaXN0b3JlXG48PGxpYnJhcnk-PlVuaXN0b3JlXG5cblBsYXllclN0b3JlIC0tPiBVbmlzdG9yZTogdXNlc1xuUGxheWVyIC0tPiBQbGF5ZXJTdG9yZTogaGFzXG5cbmNsYXNzIFBsYXllclN0YXRlIHtcbiAgICA8PGludGVyZmFjZT4-XG4gICAgc3JjOiBTb3VyY2VbXVxuICAgIGN1cnJlbnRUaW1lOiBudW1iZXJcbiAgICB2b2x1bWU6IG51bWJlclxuICAgIHRyaW0_OiBNZWRpYVRyaW1cbiAgICBpblZpZXdwb3J0OiBib29sZWFuXG4gICAgLi4uXG59XG5cblBsYXllciAtLT4gUGxheWVyU3RhdGU6IGltcGxlbWVudHNcblBsYXllclN0b3JlIC0tPiBQbGF5ZXJTdGF0ZTogaW1wbGVtZW50c1xuXG5jbGFzcyBNZWRpYVRyaW0ge1xuICAgIDw8aW50ZXJmYWNlPj5cbiAgICBzdGFydFRpbWU6IG51bWJlclxuICAgIGVuZFRpbWU6IG51bWJlclxuICAgIGR1cmF0aW9uOiBudW1iZXJcbn1cblxuUGxheWVyU3RhdGUgLS0gTWVkaWFUcmltIiwibWVybWFpZCI6e30sInVwZGF0ZUVkaXRvciI6ZmFsc2V9)

### Why `PlayerStore`?

- It provides an easy way to share/save/sync a snapshot of the state of the player at any time.
- Easy to subscribe to changes over-time instead of using multiple event listeners.
- Easy to time travel and view the state of the player at any time in the past, simply push state
  as it comes through on to a stack.
- The state object is a fresh clone each time it's changed so it's safe for the consumer to mess with.
- Easier to consume from client side when building UI with React Hooks, Svelte Stores or Vue
  Composition API.

## Providers

The player will manage as much functionality as possible to avoid colliding with providers and for
consistency across them. This includes features like `autoplay`, `loop` and even rendering. By enabling
the player to control when a provider is rendered we can open new features such as:

- Multiple providers can be passed in at the same time and cached. Providers can also potentially
  be loaded and prepared in the background.
- The player can select which source/s and provider to render based on a [media load strategy](#media-load-strategy).
- [Boot strategies](#boot-strategy) become possible which determine how/when a provider is loaded.
  Whether it is lazily loaded, when the poster is clicked, immediately or based on some custom logic.

[![](https://mermaid.ink/img/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFlvdVR1YmVcbmNsYXNzIFZpbWVvXG5jbGFzcyBEYWlseW1vdGlvblxuY2xhc3MgRW1iZWRcblxuWW91VHViZSAtLSBFbWJlZDogdXNlc1xuVmltZW8gLS0gRW1iZWQ6IHVzZXNcbkRhaWx5bW90aW9uIC0tIEVtYmVkOiB1c2VzXG5cbmNsYXNzIEVtYmVkZWRNZWRpYVByb3ZpZGVyflBhcmFtc1R5cGUsTWVzc2FnZVR5cGV-IHtcbiAgICA8PGFic3RyYWN0Pj5cbiAgICAjZW1iZWQ_OiBIVE1MVm1FbWJlZEVsZW1lbnRcbiAgICAjZW1iZWRTcmM_OiBzdHJpbmdcblxuICAgIGdldE1lZGlhVGl0bGUoKSogc3RyaW5nfHVuZGVmaW5lZFxuICAgIGdldE9yaWdpbigpKiBzdHJpbmdcbiAgICBidWlsZFBhcmFtcygpKiBQYXJhbXNUeXBlXG4gICAgZ2V0RGVjb2RlcigpKiBEZWNvZGVyXG4gICAgZ2V0UHJlY29ubmVjdGlvbnMoKSpcbiAgICBvbkVtYmVkTG9hZGVkKCkqXG4gICAgb25FbWJlZE1lc3NhZ2UoQ3VzdG9tRXZlbnR-TWVzc2FnZVR5cGV-IGV2ZW50KSpcbiAgICBvbkVtYmVkU3JjQ2hhbmdlKCkqXG59XG5cbkVtYmVkZWRNZWRpYVByb3ZpZGVyIDx8LS0gWW91VHViZTogZXh0ZW5kc1xuRW1iZWRlZE1lZGlhUHJvdmlkZXIgPHwtLSBWaW1lbzogZXh0ZW5kc1xuRW1iZWRlZE1lZGlhUHJvdmlkZXIgPHwtLSBEYWlseW1vdGlvbjogZXh0ZW5kc1xuXG5jbGFzcyBWaWRlb1xuY2xhc3MgQXVkaW9cbmNsYXNzIEZpbGVcbmNsYXNzIEhMU1xuY2xhc3MgREFTSFxuXG5jbGFzcyBNZWRpYUZpbGVQcm92aWRlciB7XG4gICAgI21lZGlhRWw_OiBIVE1MTWVkaWFFbGVtZW50XG4gICAgK2Nyb3NzT3JpZ2luPzogdHJ1ZSB8IGFub255bW91cyB8IGNyZWRlbnRpYWxzXG4gICAgK3ByZWxvYWQ_OiB0cnVlIHwgbm9uZSB8IG1ldGFkYXRhIHwgYXV0b1xuICAgICtwb3N0ZXI_OiBzdHJpbmdcbiAgICArY29udHJvbHNMaXN0Pzogc3RyaW5nXG4gICAgK2F1dG9QaVA_OiBzdHJpbmdcbiAgICArZGlzYWJsZVBpUD86IGJvb2xlYW5cbiAgICArZGlzYWJsZVJlbW90ZVBsYXliYWNrPzogYm9vbGVhblxufVxuXG5GaWxlIDx8LS0gQXVkaW86IGV4dGVuZHNcbkZpbGUgPHwtLSBWaWRlbzogZXh0ZW5kc1xuTWVkaWFGaWxlUHJvdmlkZXIgPHwtLSBGaWxlOiBleHRlbmRzXG5NZWRpYUZpbGVQcm92aWRlciA8fC0tIEhMUzogZXh0ZW5kc1xuTWVkaWFGaWxlUHJvdmlkZXIgPHwtLSBEQVNIOiBleHRlbmRzXG5cbmNsYXNzIE1lZGlhUHJvdmlkZXJ-SW50ZXJuYWxQbGF5ZXJUeXBlfiB7XG4gICAgPDxhYnN0cmFjdD4-XG4gICAgI2NvbnRyb2xzOiBib29sZWFuXG4gICAgI2xhbmd1YWdlOiBzdHJpbmdcbiAgICAjcGxheXNpbmxpbmU6Ym9vbGVhblxuXG4gICAgcGxheSgpKiBQcm9taXNlfnZvaWR-XG4gICAgcGF1c2UoKSogUHJvbWlzZX52b2lkflxuICAgIGNhblBsYXkodHlwZTogc3RyaW5nKSogdm9pZFxuICAgIGxvYWRNZWRpYShzcmM6IFNvdXJjZVtdKSogdm9pZFxuICAgIGdldEludGVybmFsUGxheWVyKCkqIEludGVybmFsUGxheWVyVHlwZVxuICAgIGdldEN1cnJlbnRWaWV3VHlwZSgpKiBWaWV3VHlwZVxuICAgIGdldEN1cnJlbnRNZWRpYVR5cGUoKSogTWVkaWFUeXBlXG4gICAgc2V0Q3VycmVudFRpbWUodGltZTogbnVtYmVyKSogdm9pZFxuICAgIHNldE11dGVkKG11dGVkOiBib29sZWFuKSogdm9pZFxuICAgIHNldFZvbHVtZSh2b2x1bWU6IG51bWJlcikqIHZvaWRcbiAgICBjYW5TZXRQbGF5YmFja1JhdGUoKSogYm9vbGVhblxuICAgIHNldFBsYXliYWNrUmF0ZShyYXRlOiBudW1iZXIpKiB2b2lkXG4gICAgY2FuU2V0UGxheWJhY2tRdWFsaXR5KCkqIGJvb2xlYW5cbiAgICBzZXRQbGF5YmFja1F1YWxpdHkocXVhbGl0eTogc3RyaW5nKSogdm9pZFxuICAgIGNhblNldEZ1bGxzY3JlZW4oKSogYm9vbGVhblxuICAgIGVudGVyRnVsbHNjcmVlbihvcHRpb25zPzogRnVsbHNjcmVlbk9wdGlvbnMpKiBQcm9taXNlfnZvaWR-XG4gICAgZXhpdEZ1bGxzY3JlZW4oKSogUHJvbWlzZX52b2lkflxuICAgIGNhblNldFBpUCgpKiBib29sZWFuXG4gICAgZW50ZXJQaVAoKSogUHJvbWlzZX52b2lkflxuICAgIGV4aXRQaVAoKSogUHJvbWlzZX52b2lkflxuICAgIHNldEN1cnJlbnRUZXh0VHJhY2sodHJhY2tJZDogbnVtYmVyKSogdm9pZFxuICAgIHNldFRleHRUcmFja1Zpc2liaWxpdHkoaXNWaXNpYmxlOiBib29sZWFuKSogdm9pZFxuICAgIGdldE1lZGlhVHJpbW1pbmcoKSogTWVkaWFUcmltfHVuZGVmaW5lZFxuICAgIGZldGNoUmVjb21tZW5kZWRBc3BlY3RSYXRpbygpKiBQcm9taXNlfnN0cmluZ35cbiAgICBmZXRjaEN1cnJlbnRQb3N0ZXIoKSogUHJvbWlzZX5zdHJpbmd-XG4gICAgZmV0Y2hDdXJyZW50TWVkaWFUaXRsZSgpKiBQcm9taXNlfnN0cmluZ35cbiAgICBmZXRjaEN1cnJlbnRNZWRpYUR1cmF0aW9uKCkqIFByb21pc2V-bnVtYmVyflxuICAgIHJlbmRlclBsYXllcigpKiBIVE1MVGVtcGxhdGVTdHJpbmdcbiAgICBkZXN0cm95KCkqIHZvaWRcbiAgICAtcmVuZGVyKCkgdm9pZFxufVxuXG5NZWRpYVByb3ZpZGVyIDx8LS0gTWVkaWFGaWxlUHJvdmlkZXJcbk1lZGlhUHJvdmlkZXIgPHwtLSBFbWJlZGVkTWVkaWFQcm92aWRlclxuXG5jbGFzcyBNZWRpYVR5cGUge1xuICAgIDw8ZW51bWVyYXRpb24-PlxuICAgIEFVRElPXG4gICAgVklERU9cbn1cblxuY2xhc3MgVmlld1R5cGUge1xuICAgIDw8ZW51bWVyYXRpb24-PlxuICAgIEFVRElPXG4gICAgVklERU9cbn1cblxuTWVkaWFUeXBlIC0tIE1lZGlhUHJvdmlkZXJcblZpZXdUeXBlIC0tIE1lZGlhUHJvdmlkZXJcblxuY2xhc3MgUGxheWVyXG5cblBsYXllciAtLSBNZWRpYVR5cGVcblBsYXllciAtLSBWaWV3VHlwZVxuUGxheWVyIFwiMVwiIC0tKiBcIjAuLipcIiBNZWRpYVByb3ZpZGVyOiBjb21wb3NpdGlvbiIsIm1lcm1haWQiOnt9LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ)](https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFlvdVR1YmVcbmNsYXNzIFZpbWVvXG5jbGFzcyBEYWlseW1vdGlvblxuY2xhc3MgRW1iZWRcblxuWW91VHViZSAtLSBFbWJlZDogdXNlc1xuVmltZW8gLS0gRW1iZWQ6IHVzZXNcbkRhaWx5bW90aW9uIC0tIEVtYmVkOiB1c2VzXG5cbmNsYXNzIEVtYmVkZWRNZWRpYVByb3ZpZGVyflBhcmFtc1R5cGUsTWVzc2FnZVR5cGV-IHtcbiAgICA8PGFic3RyYWN0Pj5cbiAgICAjZW1iZWQ_OiBIVE1MVm1FbWJlZEVsZW1lbnRcbiAgICAjZW1iZWRTcmM_OiBzdHJpbmdcblxuICAgIGdldE1lZGlhVGl0bGUoKSogc3RyaW5nfHVuZGVmaW5lZFxuICAgIGdldE9yaWdpbigpKiBzdHJpbmdcbiAgICBidWlsZFBhcmFtcygpKiBQYXJhbXNUeXBlXG4gICAgZ2V0RGVjb2RlcigpKiBEZWNvZGVyXG4gICAgZ2V0UHJlY29ubmVjdGlvbnMoKSpcbiAgICBvbkVtYmVkTG9hZGVkKCkqXG4gICAgb25FbWJlZE1lc3NhZ2UoQ3VzdG9tRXZlbnR-TWVzc2FnZVR5cGV-IGV2ZW50KSpcbiAgICBvbkVtYmVkU3JjQ2hhbmdlKCkqXG59XG5cbkVtYmVkZWRNZWRpYVByb3ZpZGVyIDx8LS0gWW91VHViZTogZXh0ZW5kc1xuRW1iZWRlZE1lZGlhUHJvdmlkZXIgPHwtLSBWaW1lbzogZXh0ZW5kc1xuRW1iZWRlZE1lZGlhUHJvdmlkZXIgPHwtLSBEYWlseW1vdGlvbjogZXh0ZW5kc1xuXG5jbGFzcyBWaWRlb1xuY2xhc3MgQXVkaW9cbmNsYXNzIEZpbGVcbmNsYXNzIEhMU1xuY2xhc3MgREFTSFxuXG5jbGFzcyBNZWRpYUZpbGVQcm92aWRlciB7XG4gICAgI21lZGlhRWw_OiBIVE1MTWVkaWFFbGVtZW50XG4gICAgK2Nyb3NzT3JpZ2luPzogdHJ1ZSB8IGFub255bW91cyB8IGNyZWRlbnRpYWxzXG4gICAgK3ByZWxvYWQ_OiB0cnVlIHwgbm9uZSB8IG1ldGFkYXRhIHwgYXV0b1xuICAgICtwb3N0ZXI_OiBzdHJpbmdcbiAgICArY29udHJvbHNMaXN0Pzogc3RyaW5nXG4gICAgK2F1dG9QaVA_OiBzdHJpbmdcbiAgICArZGlzYWJsZVBpUD86IGJvb2xlYW5cbiAgICArZGlzYWJsZVJlbW90ZVBsYXliYWNrPzogYm9vbGVhblxufVxuXG5GaWxlIDx8LS0gQXVkaW86IGV4dGVuZHNcbkZpbGUgPHwtLSBWaWRlbzogZXh0ZW5kc1xuTWVkaWFGaWxlUHJvdmlkZXIgPHwtLSBGaWxlOiBleHRlbmRzXG5NZWRpYUZpbGVQcm92aWRlciA8fC0tIEhMUzogZXh0ZW5kc1xuTWVkaWFGaWxlUHJvdmlkZXIgPHwtLSBEQVNIOiBleHRlbmRzXG5cbmNsYXNzIE1lZGlhUHJvdmlkZXJ-SW50ZXJuYWxQbGF5ZXJUeXBlfiB7XG4gICAgPDxhYnN0cmFjdD4-XG4gICAgI2NvbnRyb2xzOiBib29sZWFuXG4gICAgI2xhbmd1YWdlOiBzdHJpbmdcbiAgICAjcGxheXNpbmxpbmU6Ym9vbGVhblxuXG4gICAgcGxheSgpKiBQcm9taXNlfnZvaWR-XG4gICAgcGF1c2UoKSogUHJvbWlzZX52b2lkflxuICAgIGNhblBsYXkodHlwZTogc3RyaW5nKSogdm9pZFxuICAgIGxvYWRNZWRpYShzcmM6IFNvdXJjZVtdKSogdm9pZFxuICAgIGdldEludGVybmFsUGxheWVyKCkqIEludGVybmFsUGxheWVyVHlwZVxuICAgIGdldEN1cnJlbnRWaWV3VHlwZSgpKiBWaWV3VHlwZVxuICAgIGdldEN1cnJlbnRNZWRpYVR5cGUoKSogTWVkaWFUeXBlXG4gICAgc2V0Q3VycmVudFRpbWUodGltZTogbnVtYmVyKSogdm9pZFxuICAgIHNldE11dGVkKG11dGVkOiBib29sZWFuKSogdm9pZFxuICAgIHNldFZvbHVtZSh2b2x1bWU6IG51bWJlcikqIHZvaWRcbiAgICBjYW5TZXRQbGF5YmFja1JhdGUoKSogYm9vbGVhblxuICAgIHNldFBsYXliYWNrUmF0ZShyYXRlOiBudW1iZXIpKiB2b2lkXG4gICAgY2FuU2V0UGxheWJhY2tRdWFsaXR5KCkqIGJvb2xlYW5cbiAgICBzZXRQbGF5YmFja1F1YWxpdHkocXVhbGl0eTogc3RyaW5nKSogdm9pZFxuICAgIGNhblNldEZ1bGxzY3JlZW4oKSogYm9vbGVhblxuICAgIGVudGVyRnVsbHNjcmVlbihvcHRpb25zPzogRnVsbHNjcmVlbk9wdGlvbnMpKiBQcm9taXNlfnZvaWR-XG4gICAgZXhpdEZ1bGxzY3JlZW4oKSogUHJvbWlzZX52b2lkflxuICAgIGNhblNldFBpUCgpKiBib29sZWFuXG4gICAgZW50ZXJQaVAoKSogUHJvbWlzZX52b2lkflxuICAgIGV4aXRQaVAoKSogUHJvbWlzZX52b2lkflxuICAgIHNldEN1cnJlbnRUZXh0VHJhY2sodHJhY2tJZDogbnVtYmVyKSogdm9pZFxuICAgIHNldFRleHRUcmFja1Zpc2liaWxpdHkoaXNWaXNpYmxlOiBib29sZWFuKSogdm9pZFxuICAgIGdldE1lZGlhVHJpbW1pbmcoKSogTWVkaWFUcmltfHVuZGVmaW5lZFxuICAgIGZldGNoUmVjb21tZW5kZWRBc3BlY3RSYXRpbygpKiBQcm9taXNlfnN0cmluZ35cbiAgICBmZXRjaEN1cnJlbnRQb3N0ZXIoKSogUHJvbWlzZX5zdHJpbmd-XG4gICAgZmV0Y2hDdXJyZW50TWVkaWFUaXRsZSgpKiBQcm9taXNlfnN0cmluZ35cbiAgICBmZXRjaEN1cnJlbnRNZWRpYUR1cmF0aW9uKCkqIFByb21pc2V-bnVtYmVyflxuICAgIHJlbmRlclBsYXllcigpKiBIVE1MVGVtcGxhdGVTdHJpbmdcbiAgICBkZXN0cm95KCkqIHZvaWRcbiAgICAtcmVuZGVyKCkgdm9pZFxufVxuXG5NZWRpYVByb3ZpZGVyIDx8LS0gTWVkaWFGaWxlUHJvdmlkZXJcbk1lZGlhUHJvdmlkZXIgPHwtLSBFbWJlZGVkTWVkaWFQcm92aWRlclxuXG5jbGFzcyBNZWRpYVR5cGUge1xuICAgIDw8ZW51bWVyYXRpb24-PlxuICAgIEFVRElPXG4gICAgVklERU9cbn1cblxuY2xhc3MgVmlld1R5cGUge1xuICAgIDw8ZW51bWVyYXRpb24-PlxuICAgIEFVRElPXG4gICAgVklERU9cbn1cblxuTWVkaWFUeXBlIC0tIE1lZGlhUHJvdmlkZXJcblZpZXdUeXBlIC0tIE1lZGlhUHJvdmlkZXJcblxuY2xhc3MgUGxheWVyXG5cblBsYXllciAtLSBNZWRpYVR5cGVcblBsYXllciAtLSBWaWV3VHlwZVxuUGxheWVyIFwiMVwiIC0tKiBcIjAuLipcIiBNZWRpYVByb3ZpZGVyOiBjb21wb3NpdGlvbiIsIm1lcm1haWQiOnt9LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ)

## Boot Strategy

**Default Strategy: LazyBootStrategy**

A boot [strategy](https://en.wikipedia.org/wiki/Strategy_pattern) controls when/how a player
is loaded the first time. The player implements the `Bootable` interface and registers
to the current boot strategy. The strategy will call the `boot()` method when it is ready to
load the player. The player will render whatever the `renderWhileBooting()` method returns
if it's available, otherwise it'll default to `<slot name="booting" />`.

[![](https://mermaid.ink/img/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFBsYXllciB7XG4gICAgLi4uXG4gICAgK2Jvb3RTdHJhdGVneTogY2xpY2sgfCBsYXp5IHwgaW1tZWRpYXRlIHwgQm9vdFN0cmF0ZWd5XG59XG5cbmNsYXNzIEJvb3RhYmxlIHtcbiAgICA8PGludGVyZmFjZT4-XG4gICAgYm9vdFRhcmdldDogSFRNTEVsZW1lbnRcbiAgICBib290KCkgUHJvbWlzZX52b2lkflxuICAgIHJlbmRlcldoaWxlQm9vdGluZygpIFRlbXBsYXRlUmVzdWx0XG59XG5cblBsYXllciAtLT4gQm9vdGFibGU6IGltcGxlbWVudHNcblxuY2xhc3MgQm9vdFN0cmF0ZWd5flQgZXh0ZW5kcyBCb290YWJsZX4ge1xuICAgIDw8aW50ZXJmYWNlPj5cbiAgICBoYXNCb290ZWQ6IGJvb2xlYW5cbiAgICByZWdpc3Rlcihib290YWJsZTogQm9vdGFibGUpIFByb21pc2V-dm9pZH5cbn1cblxuY2xhc3MgTGF6eUJvb3RTdHJhdGVneVxuY2xhc3MgQ2xpY2tCb290U3RyYXRlZ3lcbmNsYXNzIEltbWVkaWF0ZUJvb3RTdHJhdGVneVxuXG5Cb290U3RyYXRlZ3kgPC0tIExhenlCb290U3RyYXRlZ3k6IGltcGxlbWVudHNcbkJvb3RTdHJhdGVneSA8LS0gQ2xpY2tCb290U3RyYXRlZ3k6IGltcGxlbWVudHNcbkJvb3RTdHJhdGVneSA8LS0gSW1tZWRpYXRlQm9vdFN0cmF0ZWd5OiBpbXBsZW1lbnRzXG5Cb290U3RyYXRlZ3kgLS0-IEJvb3RhYmxlXG5cblBsYXllciAtLSBCb290U3RyYXRlZ3k6IHVzZSIsIm1lcm1haWQiOnt9LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ)](https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFBsYXllciB7XG4gICAgLi4uXG4gICAgK2Jvb3RTdHJhdGVneTogY2xpY2sgfCBsYXp5IHwgaW1tZWRpYXRlIHwgQm9vdFN0cmF0ZWd5XG59XG5cbmNsYXNzIEJvb3RhYmxlIHtcbiAgICA8PGludGVyZmFjZT4-XG4gICAgYm9vdFRhcmdldDogSFRNTEVsZW1lbnRcbiAgICBib290KCkgUHJvbWlzZX52b2lkflxuICAgIHJlbmRlcldoaWxlQm9vdGluZygpIFRlbXBsYXRlUmVzdWx0XG59XG5cblBsYXllciAtLT4gQm9vdGFibGU6IGltcGxlbWVudHNcblxuY2xhc3MgQm9vdFN0cmF0ZWd5flQgZXh0ZW5kcyBCb290YWJsZX4ge1xuICAgIDw8aW50ZXJmYWNlPj5cbiAgICBoYXNCb290ZWQ6IGJvb2xlYW5cbiAgICByZWdpc3Rlcihib290YWJsZTogQm9vdGFibGUpIFByb21pc2V-dm9pZH5cbn1cblxuY2xhc3MgTGF6eUJvb3RTdHJhdGVneVxuY2xhc3MgQ2xpY2tCb290U3RyYXRlZ3lcbmNsYXNzIEltbWVkaWF0ZUJvb3RTdHJhdGVneVxuXG5Cb290U3RyYXRlZ3kgPC0tIExhenlCb290U3RyYXRlZ3k6IGltcGxlbWVudHNcbkJvb3RTdHJhdGVneSA8LS0gQ2xpY2tCb290U3RyYXRlZ3k6IGltcGxlbWVudHNcbkJvb3RTdHJhdGVneSA8LS0gSW1tZWRpYXRlQm9vdFN0cmF0ZWd5OiBpbXBsZW1lbnRzXG5Cb290U3RyYXRlZ3kgLS0-IEJvb3RhYmxlXG5cblBsYXllciAtLSBCb290U3RyYXRlZ3k6IHVzZSIsIm1lcm1haWQiOnt9LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ)

## Media Load Strategy

**Default Strategy: FirstCanPlayMediaLoadStrategy**

The media load [strategy](https://en.wikipedia.org/wiki/Strategy_pattern) controls which source/s
are loaded and by which provider.

## Player Management

[![](https://mermaid.ink/img/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFBsYXllclJlZ2lzdHJ5IiwibWVybWFpZCI6e30sInVwZGF0ZUVkaXRvciI6ZmFsc2V9)](https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFBsYXllclJlZ2lzdHJ5IiwibWVybWFpZCI6e30sInVwZGF0ZUVkaXRvciI6ZmFsc2V9)

## MediaSync

[![](https://mermaid.ink/img/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIE1lZGlhU3luYyIsIm1lcm1haWQiOnt9LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ)](https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIE1lZGlhU3luYyIsIm1lcm1haWQiOnt9LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ)

## UI

[![](https://mermaid.ink/img/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFVJIiwibWVybWFpZCI6e30sInVwZGF0ZUVkaXRvciI6ZmFsc2V9)](https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFVJIiwibWVybWFpZCI6e30sInVwZGF0ZUVkaXRvciI6ZmFsc2V9)

## Player Update Flow

Using setting the `paused` property to `false` as an example:

- Provider updates the prop -> Player listens for `ProviderPlay` event and updates prop in the
  `PlayerStore`.
- UI updates the prop -> Player listens for `UIPlay` event and updates prop in the
  `PlayerStore` + calls `setPaused(false)` on `currentProvider`.
- Developer updates prop -> Change is noticed through prop setter and it updates prop in the
  `PlayerStore` + calls `setPaused` on `currentProvider`. A `DevPlay` event may be emitted?

Note: When you are "getting" a property value from the `Player` that is part of `PlayerState` you
are actually just returning the current value from the `PlayerStore`.

## Questions/Thoughts

- How to handle readonly properties??
- Strict naming convention? paused vs. isPaused?
- Show flows between Player -> Providers
- Show flows between Player → UI.
- Show flows between I18N → UI.
- Show cross component comms Controls → Captions/Settings (Collision detection).
- PlayerEventListener API.
- List all events (System/User) for Furf to make sure we've covered everything.
- Show UI Design patterns (Functional / CSS Classes / Toggle).
- Custom UI on IOS using Canvas?
- Custom PIP mode with Canvas?
- Stream chunks to indexdb?? Maybe save content as part of a session that can be cleared whenever?
- Offline mode? -> OfflineStrategy? -> save for another day?
- Caching -> CacheStrategy?
- Media Session?
- Playlists?? -> most likely external
- Ads? -> What happens to some UI when Ad playing?
